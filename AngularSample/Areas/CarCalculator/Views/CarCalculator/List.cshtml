
<script type="text/javascript">
    var form = $("#fuelEntryForm");
    form.validate({
        errorPlacement: function errorPlacement(error, element) { element.before(error); },
        rules: {
            confirm: {
                equalTo: "#password"
            }
        }
    });
    form.children("div").steps({
        headerTag: "h3",
        bodyTag: "section",
        transitionEffect: "slideLeft",
        onStepChanging: function (event, currentIndex, newIndex) {
            form.validate().settings.ignore = ":disabled,:hidden";
            return form.valid();
        },
        onFinishing: function (event, currentIndex) {
            form.validate().settings.ignore = ":disabled";
            return form.valid();
        },
        onFinished: function (event, currentIndex) {
            alert("Submitted!");
        }
    });
</script>

<div class="panel panel-default" ng-controller="CarCalculatorController">
    <div class="panel-heading">
        <h3 class="panel-title">Wszystkie tankowania</h3>
    </div>
    <div class="panel-body">
        <button class="btn btn-primary btn-lg" ng-click="checkIfMobile()">
            <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> IsMobile
        </button>


        <div class="brn-group pull-right">
            <button class="btn btn-primary btn-lg" data-toggle="modal" ng-click="newEntryForm()">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Nowe tankowanie
            </button>
        </div>
        <table ng-table="tableParams" class="table table-condensed table-bordered table-hover">


            <tr class="ng-table-group" ng-repeat-start="group in $groups">
                <td colspan="5">
                    <a href="" ng-click="group.$hideRows = !group.$hideRows">
                        <span class="glyphicon" ng-class="{ 'glyphicon-chevron-right': group.$hideRows, 'glyphicon-chevron-down': !group.$hideRows }"></span>
                        <strong>{{ group.value }}</strong>
                    </a>
                </td>
            </tr>
            <tr ng-hide="group.$hideRows" ng-class="{success: entry.id === newRowId}" ng-repeat="entry in group.data">

                <td sortable="date" data-title="'Data'">
                    {{entry.date | date: 'yyyy-MM-dd'}}
                </td>
                <td sortable="amountOfFuel" data-title="'Zatankowano'">
                    {{entry.amountOfFuel}}
                </td>
                <td sortable="gasPrice" data-title="'Cena paliwa'">
                    {{entry.gasPrice}}
                </td>
                <td sortable="distance" data-title="'Przebieg'">
                    {{entry.distance}}
                </td>

                <td sortable="distance" data-title="'Przebieg'">
                    {{entry.currentDistance}}
                </td>

            </tr>

            <tr ng-repeat-end>
                <td class="text-success text-right"><strong>Podsumowanie:</strong></td>
                <td><em>Spalanie(l/100km): {{calcSum(group.data).a | number:2}}</em></td>
            </tr>
            <tfoot ng-if="demo.isLastPage()">
            <tr>
                <td class="text-success text-right"><strong>Grant Total:</strong></td>

            </tr>
            </tfoot>
        </table>

        <div class="modal fade" id="nonMobileForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Nowe tankowanie</h4>
                    </div>
                    <div class="modal-body">



                        <form class="form-horizontal" name="fuelEntryForm" novalidate>
                            <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.date.$invalid}">
                                <label for="date" class="col-sm-4 control-label">Data tankowania:</label>
                                <div class="col-sm-7">
                                    <input type="date" class="form-control" name="date" placeholder="Data tankowania" ng-model="currentEntry.date" required>
                                </div>
                            </div>

                            <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.amountOfFuel.$invalid}">
                                <label class="col-sm-4 control-label">Zatankowano:</label>
                                <div class="col-sm-7">
                                    <input class="form-control" name="amountOfFuel" required type="number" ng-model="currentEntry.amountOfFuel" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="1" min="0.01">
                                </div>
                            </div>
                            <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.gasPrice.$invalid}">
                                <label class="col-sm-4 control-label">Cena paliwa:</label>
                                <div class="col-sm-7">
                                    <input class="form-control" name="gasPrice" required type="number" ng-model="currentEntry.gasPrice" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="0.01" min="0.01">
                                </div>
                            </div>
                            <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.distance.$invalid}">
                                <label class="col-sm-4 control-label">Przebieg:</label>
                                <div class="col-sm-7">
                                    <input class="form-control" name="distance" required type="number" ng-model="currentEntry.distance" placeholder="Większe niż {{lastDistance}}" min="{{lastDistance}}">
                                </div>
                            </div>
                            <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.currentDistance.$invalid}">
                                <label class="col-sm-4 control-label">Przejechano:</label>
                                <div class="col-sm-7">
                                    <input class="form-control" name="currentDistance" required type="number" ng-model="currentEntry.currentDistance" min="1">
                                </div>
                            </div>

                            <div class="modal-footer">
                                <button class="closeModal btn btn-default" type="button" data-dismiss="modal">Zamknij</button>
                                <button type="button" class="btn btn-primary" value="Dodaj" ng-disabled="!fuelEntryForm.$valid" ng-click="addFuelEntry()">Zapisz</button>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>


        <div class="modal fade" id="mobileForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Nowe tankowanie</h4>
                    </div>
                    <div class="modal-body">



                        <form id="fuelEntryForm" name="fuelEntryForm" novalidate>
                            <div id="example-basic">
                                <h3></h3>
                                <section>
                                    <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.date.$invalid}">
                                        <label for="date" >Data tankowania:</label>
                                        <div >
                                            <input type="date" class="form-control" name="date" placeholder="Data tankowania" ng-model="currentEntry.date" required>
                                        </div>
                                    </div>
                                </section>
                                <h3></h3>
                                <section>
                                    <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.amountOfFuel.$invalid}">
                                        <label >Zatankowano:</label>
                                        <div >
                                            <input class="form-control" name="amountOfFuel" required type="number" ng-model="currentEntry.amountOfFuel" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="1" min="0.01">
                                        </div>
                                    </div>
                                </section>
                                <h3></h3>
                                <section>
                                    <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.gasPrice.$invalid}">
                                        <label >Cena paliwa:</label>
                                        <div >
                                            <input class="form-control" name="gasPrice" required type="number" ng-model="currentEntry.gasPrice" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="0.01" min="0.01">
                                        </div>
                                    </div>

                                </section>

                                <h3></h3>
                                <section>
                                    <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.distance.$invalid}">
                                        <label >Przebieg:</label>
                                        <div >
                                            <input class="form-control" name="distance" required type="number" ng-model="currentEntry.distance" placeholder="Większe niż {{lastDistance}}" min="{{lastDistance}}">
                                        </div>
                                    </div>
                                   
                                </section>
                                
                                <h3></h3>
                                <section>
                                    <div class="form-group" ng-class="{ 'has-error' : fuelEntryForm.currentDistance.$invalid}">
                                        <label >Przejechano:</label>
                                        <div >
                                            <input class="form-control" name="currentDistance" required type="number" ng-model="currentEntry.currentDistance" min="1">
                                        </div>
                                    </div>
                                   
                                </section>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


